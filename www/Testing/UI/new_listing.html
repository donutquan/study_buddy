
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">

    <title>Study Buddy</title>
    <style>
    .logo-image {
        /* padding-top: 10px;
        position: relative; */
        width: 100px;
        height: 100px;
        position: relative;
        overflow: hidden;
        border-radius: 50%;
      } 
      
    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
        /* border-radius: 50%; 
        overflow: hidden;
        width: 125px; 
        height: 125px; */
      }

    img{
        display: inline;
        margin: 0 auto;
        margin-left: -25%;
        height: 100%;
        width: auto;
    }
    
    .line{
        display:inline-block;
        border-bottom:2px #5B3400 solid;
        margin-left:5px;
        width:80%;
    }
    </style>
    <link href="dashboard.css" rel="stylesheet">

    <!-- NEW SCRIPT FOR VUE -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>

  </head>
  <body>
    <header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
      <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">Study Buddy</a>
      <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </header>
    
  <div class="container-fluid">
      <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
          <div class="position-sticky pt-3">
            <ul class="nav flex-column">
              <div class="logo-image center">
                  <span>
                    <img src="cat.png" class="rounded img_logo">
                  </span>
              </div>
              <li class="nav-item center">
                <a class="nav-link">
                  @{{ username }}
                </a>
              </li>
              <br>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="homepage.html">
                  View All Listings
                </a>
              </li>
              <li class="nav-item" style="list-style-type: none">
                <a class="nav-link" href="my_homework.html">
                  Your Homework
                       <li style="padding: 0px 0px 0px 32px;" ><a class="nav-link" href="open_homework.html">Open</a></li>
                       <li style="padding: 0px 0px 0px 32px;"><a class="nav-link" href="progress_homework.html">In Progress</a></li>
                       <li style="padding: 0px 0px 0px 32px;"><a class="nav-link" href="completed_homework.html">Completed</a></li>
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="new_listing.html">
                  Create New Listing
                </a>
              </li>

              <li class="nav-item text-nowrap">
                <a class="nav-link" href="#" style="color: red;">Sign out</a>
              </li> 
            </ul>
          </div>
        </nav>
          <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 ">
              <h1 class="h2">Create New Homework Listing</h1>
            </div>
            

            <form class="py-3" id="new_homework">

              <div class="form-group pb-3">
                  <label for="homework_image">Select image of Homework:</label>
                  <input type="file" class="form-control form-control-sm" id="homework_image">
              </div>

              <div class="form-group pb-3">
                  Subject of Homework:
                  <br>
                  <input type="checkbox" class="custom-control-input" id="subject">
                  <label class="custom-control-label" for="subject">Science</label> &nbsp;
                  <input type="checkbox" class="custom-control-input" id="subject"> 
                  <label class="custom-control-label" for="subject">Maths</label> &nbsp;
                  <input type="checkbox" class="custom-control-input" id="subject">
                  <label class="custom-control-label" for="subject">English</label> &nbsp;
                  <input type="checkbox" class="custom-control-input" id="subject">
                  <label class="custom-control-label" for="subject">Social Science</label> &nbsp;
                  
              </div>
  
              <div class="form-group pb-3">
                  <label for="listing_title">Listing Title</label>
                  <input type="text" class="form-control form-control-sm" id="listing_title">
              </div>
  
              <div class="form-group pb-3">
                  <label for="price">Price of Homework ($)</label>
                  <input type="number" class="form-control form-control-sm" id="price">
              </div>

              <div class="form-group pb-3">
                  Description of Homework:
                  <br>
                  <textarea name="description" rows="4" cols="50"></textarea>
              </div>

              <div class="form-group pb-3">
                <label for="deadline">Deadline</label>
                <input type="date" class="form-control form-control-sm" id="deadline">
              </div>
              
              <div class="form-group pb-3">
                  Choice of Meeting:
                  <br>
                  <input type="checkbox" class="custom-control-input" id="meeting">
                  <label class="custom-control-label" for="meeting">Zoom</label> <br>
                  <input type="checkbox" class="custom-control-input" id="meeting"> 
                  <label class="custom-control-label" for="meeting">Chat</label> <br>
              </div>


              <button type="submit" class="btn btn-primary my-3" style="float:right;">Create New Homework Listing</button>
            </form>
          </main>
        </div>
    </div>

          <script>
            var get_all_URL = "http://localhost:5100/homework";
            var get_user_URL = "http://localhost:5000/user";

            var sidebar = new Vue ({
              el: "#sidebarMenu",
              data: {
                username: `${localStorage.getItem("username")}`
              }

            });

            var app = new Vue({
                el: "#app",
                
                data: {
                    username: `${localStorage.getItem("username")}`,
                    "homework": [],
                    message: "There is a problem retrieving homework data, please try again later.",
                    // newTitle: "",
                    // newISBN13: "",
                    // newPrice: "",
                    // newAvailability: "",
                    // bookAdded: false,
                    // addBookError: "",
                    // orderedBook: "",
                    // orderPlaced: false,
                    // orderSuccessful: false,
                },
                methods: {
                    
                    findUser: function () {
                    console.log(this.username);
                    const response =
                        fetch(`${get_user_URL}/${this.username}`)
                            .then(response => response.json())
                            .then(data => {
                                console.log(response);
                                if (data.code === 404) {
                                    // no book in db
                                    this.message = data.message;
                                    this.books = [];
                                } else {
                                    this.books = [data.data];
                                }
                            })
                            .catch(error => {
                                // Errors when calling the service; such as network error, 
                                // service offline, etc
                                console.log(this.message + error);

                            });

                    },
                //     addBook: function () {
                //         // reset data
                //         this.bookAdded = false;
                //         this.addBookError = "";
    
                //         let jsonData = JSON.stringify({
                //             title: this.newTitle,
                //             price: this.newPrice,
                //             availability: this.newAvailability
                //         });
    
                //         fetch(`${get_all_URL}/${this.newISBN13}`,
                //             {
                //                 method: "POST",
                //                 headers: {
                //                     "Content-type": "application/json"
                //                 },
                //                 body: jsonData
                //             })
                //             .then(response => response.json())
                //             .then(data => {
                //                 console.log(data);
                //                 result = data.data;
                //                 console.log(result);
                //                 // 3 cases
                //                 switch (data.code) {
                //                     case 201:
                //                         this.bookAdded = true;
    
                //                         // refresh book list
                //                         this.getAllBooks();
    
                //                         // an alternate way is to add this one element into this.books
                //                         break;
                //                     case 400:
                //                     case 500:
                //                         this.addBookError = data.message;
                //                         break;
                //                     default:
                //                         throw `${data.code}: ${data.message}`;
                //                 }
                //             })
                //     },
                //     placeOrder: function (book) {
    
                //         // use this to trigger an error
                //         // "customer_id": "ERROR",
                //         this.orderedBook = book;
                //         fetch(place_order_URL,
                //             {
                //                 method: "POST",
                //                 headers: {
                //                     "Content-type": "application/json"
                //                 },
                //                 body: JSON.stringify(
                //                     {
                //                         "customer_id": "Apple TAN",
                //                         "cart_item": [{
                //                             "book_id": book.isbn13,
                //                             "quantity": 1
                //                         }]
                //                     })
                //             })
                //             .then(response => response.json())
                //             .then(data => {
                //                 console.log(data);
                //                 result = data.data;
                //                 console.log(result);
                //                 // 3 cases
                //                 switch (data.code) {
                //                     case 201:
                //                         // 201
                //                         this.orderSuccessful = true;
                //                         orderMessage =
                //                             `Order placed
                //                             Order Result:
                //                             ${result.order_result.code}:${result.order_result.data.status}
    
                //                             Shipping Result:
                //                             ${result.shipping_result.code}:${result.shipping_result.message}`;
                //                         break;
    
                //                     case 400:
                //                         // 400 
                //                         this.orderSuccessful = true;
                //                         orderMessage =
                //                             `Order placed
                //                             Order Result:
                //                             ${result.order_result.code}:${result.order_result.data.status}
    
                //                             Shipping Result:
                //                             ${result.shipping_result.code}:${result.shipping_result.message}
    
                //                             Error handling:
                //                             ${data.message}`;
                //                         break;
                //                     case 500:
                //                         // 500 
                //                         orderMessage =
                //                             `Order placed with error:
                //                             Order Result:
                //                             ${result.order_result.code}:${result.order_result.message}
    
                //                             Error handling:
                //                             ${data.message}`;
                //                         break;
                //                     default:
                //                         orderMessage = `Unexpected error: ${data.code}`;
                //                         console.log(`Unknown error code : ${data.code}`);
                //                         break;
    
                //                 } // switch
                //                 console.log(orderMessage);
                //                 this.orderPlaced = true;
                //             })
                //             .catch(error => {
                //                 console.log("Problem in placing an order. " + error);
                //             })
                //     }
                }
            });
          </script>

    <!-- Optional JavaScript; choose one of the two! -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
  </body>
</html>